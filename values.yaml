# Global configuration
global:
  registry: "demodeckacr.azurecr.io"
  imageTag: "v1.0.0"
  imagePullPolicy: IfNotPresent
  environment: "development"

# Tenant API Configuration (Single Version)
tenantApi:
  name: tenant-api
  image: demodeck-tenant-api
  tag: "v1.0.1"
  port: 5121
  replicaCount: 2
  host: "tenant-api.demodeck.xyz"
  resources:
    requests:
      memory: "512Mi"
      cpu: "300m"
    limits:
      memory: "1Gi"
      cpu: "600m"
  livenessProbe:
    path: /health
    port: 5121
    initialDelaySeconds: 30
    periodSeconds: 10
  readinessProbe:
    path: /health
    port: 5121
    initialDelaySeconds: 5
    periodSeconds: 5
  env:
    ASPNETCORE_ENVIRONMENT: "Development"
    ASPNETCORE_URLS: "http://+:5121"
    Cors__AllowedOrigins__0: "https://acme.demodeck.xyz" #Wildcard domains: http://*.demodeck.xyz isn't valid - wildcards only work with HTTPS in .NET CORS
    Cors__AllowedOrigins__1: "https://tenantregistry.demodeck.xyz"
    Cors__AllowedOrigins__2: "https://*.demodeck.xyz"
    Cors__AllowCredentials: "true"
    Cors__AllowedHeaders__0: "*"
    Cors__AllowedMethods__0: "*"

# Auth API Configuration (Single Version)
authApi:
  name: auth-api
  image: demodeck-auth-api
  tag: "v1.0.0"
  port: 5001
  replicaCount: 2
  host: "auth-api.demodeck.xyz"
  resources:
    requests:
      memory: "256Mi"
      cpu: "200m"
    limits:
      memory: "512Mi"
      cpu: "400m"
  livenessProbe:
    path: /health
    port: 5001
    initialDelaySeconds: 30
    periodSeconds: 10
  readinessProbe:
    path: /health
    port: 5001
    initialDelaySeconds: 5
    periodSeconds: 5
  env:
    ASPNETCORE_ENVIRONMENT: "Development"
    ASPNETCORE_URLS: "http://+:5001"
    TenantUrl: "https://tenant-api.demodeck.xyz/api/tenant/"    
    Cors__AllowedOrigins__0: "https://acme.demodeck.xyz"
    Cors__AllowedOrigins__1: "https://*.demodeck.xyz"
    Cors__AllowCredentials: "true"
    Cors__AllowedHeaders__0: "*"
    Cors__AllowedMethods__0: "*"

# Product API Configuration (Single Version)
productApi:
  name: product-api
  image: demodeck-product-api
  tag: "v1.0.0"
  port: 5002
  replicaCount: 3
  host: "product-api.demodeck.xyz"
  resources:
    requests:
      memory: "512Mi"
      cpu: "300m"
    limits:
      memory: "1Gi"
      cpu: "600m"
  livenessProbe:
    path: /health
    port: 5002
    initialDelaySeconds: 30
    periodSeconds: 10
  readinessProbe:
    path: /health
    port: 5002
    initialDelaySeconds: 5
    periodSeconds: 5
  env:
    ASPNETCORE_ENVIRONMENT: "Development"
    ASPNETCORE_URLS: "http://+:5002"    
    Cors__AllowedOrigins__0: "https://acme.demodeck.xyz"
    Cors__AllowedOrigins__1: "https://*.demodeck.xyz"
    Cors__AllowCredentials: "true"
    Cors__AllowedHeaders__0: "*"
    Cors__AllowedMethods__0: "*"


# Tenant Registry UI Configuration
tenantRegistryUi:
  name: tenant-registry-ui
  image: demodeck-tenant-registry-ui
  tag: "v1.0.1"
  replicaCount: 2
  port: 80
  host: "tenantregistry.demodeck.xyz"
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  livenessProbe:
    path: /
    port: 80
    initialDelaySeconds: 30
    periodSeconds: 10
  readinessProbe:
    path: /
    port: 80
    initialDelaySeconds: 5
    periodSeconds: 5

# Tenant-specific UIs (1 instance for now)
tenantUis:
  acme:
    name: acme-ui
    image: demodeck-tenant-ui
    tag: "acme-v4"
    replicaCount: 1
    port: 80
    host: "acme.demodeck.xyz"
    resources:
      requests:
        memory: "128Mi"
        cpu: "100m"
      limits:
        memory: "256Mi"
        cpu: "200m"

  #Example: Additional tenant configuration for multi-tenant setup
  # initech:
  #   name: initech-ui
  #   image: demodeck-tenant-ui
  #   tag: "initech-v1.0.0"
  #   replicaCount: 1
  #   port: 80
  #   host: "initech.demodeck.xyz"
  #   resources:
  #     requests:
  #       memory: "128Mi"
  #       cpu: "100m"
  #     limits:
  #       memory: "256Mi"
  #       cpu: "200m"

# Ingress Configuration for NGINX
ingress:
  enabled: true
  className: "nginx"
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  tls:
    enabled: true
    secretName: demodeck-tls

# Horizontal Pod Autoscaler
autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

# Service Configuration
service:
  type: ClusterIP
  port: 80

# Service Account
serviceAccount:
  create: true
  annotations: {}
  name: ""

# Security
podSecurityContext:
  runAsNonRoot: false
  runAsUser: 0

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: false

# Node selection
nodeSelector: {}
tolerations: []
affinity: {}